(function(n,t){typeof define=="function"&&define.amd?define("Combo",["jquery"],function(i){return t(i,n)}):typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("jquery"),global||n):n.Combo=t(n.jQuery,n)})(this,function(n,t){var i=function(){function i(n){var t=n.toLowerCase();return t=t.replace(new RegExp(/[àáâãäå]/g),"a"),t=t.replace(new RegExp(/[èéêë]/g),"e"),t=t.replace(new RegExp(/[ìíîï]/g),"i"),t=t.replace(new RegExp(/[òóôõö]/g),"o"),t.replace(new RegExp(/[ùúûü]/g),"u")}var t=function(n){this.parseOptions(n);this.init()};return n.extend(t.prototype,{options:{name:"",view:"",cantItems:null,persist:!1,create:!1,actionController:"",actionControllerSelect:"",selectValue:null,search:null,cascadeCombo:null,removeValue:null,disable:!1,callback:null,change:null,minCantSearchChar:3,delimiter:",",myClass:""},init:function(){return Selectize.define("enter_key",function(){var n=this;this.onKeyDown=function(){var t=n.onKeyDown;return function(n){if(n.keyCode===188)n.preventDefault();else return t.apply(this,arguments)}}()}),this},createBasicCombo:function(){var t=this.options;n("#pnl"+t.name+t.view).load(t.actionController,{search:t.search,identif:"ddl"+t.name+t.view},function(i,r){if(r=="success"){var u=n("#ddl"+t.name+t.view).selectize({plugins:["remove_button","enter_key"],maxItems:t.cantItems,onChange:function(i){var r=u[0].selectize.items,f=r.map(function(n){return u[0].selectize.options[n].text}).join(t.delimiter);n("#hSel"+t.name)&&n("#hSel"+t.name).val(f);n("#h"+t.name+t.view).val(i);t.cascadeCombo&&t.cascadeCombo();t.change&&t.change()}});u[0].selectize.clear(!0);t.removeValue&&u[0].selectize.removeOption(t.removeValue);u[0].selectize.order==0?(n("#h"+t.name+t.view).val(""),n("#hSel"+t.name)&&n("#hSel"+t.name).val(""),t.cascadeCombo&&t.cascadeCombo()):t.selectValue?u[0].selectize.setValue(t.selectValue):(n("#h"+t.name+t.view).val(""),t.cascadeCombo&&t.cascadeCombo());t.disable&&u[0].selectize.disable();t.callback&&t.callback();t.myClass!=""&&n(this).find(".selectize-control > .selectize-input").addClass(t.myClass)}else CargarAlertas(t.view)})},createSearchCombo:function(){var t=this.options,r=[],u=n("#ddl"+t.name+t.view).selectize({plugins:["remove_button","enter_key"],maxItems:t.cantItems,persist:!1,diacritics:!0,create:t.create,valueField:t.valueField,labelField:t.labelField,searchField:t.labelField,sortField:[{field:t.labelField,direction:"asc"},{field:"$score"}],options:[],onChange:function(i){var u=[];i!=null&&(n.isArray(i)?i.forEach(function(t){n.inArray(t,r)>=0||u.push(t)}):u.push(i));n("#h"+t.name+t.view).val(u.join(t.delimiter));n("#h"+t.name+t.view+"Like").val(r);t.change&&t.change()},score:function(r){r=i(r);var f=this.getScoreFunction(r),u=this;return function(i){if(r.length<t.minCantSearchChar){if(u.loadedSearches={"":!0},n.inArray(i.Id.toString(),u.items)<0)return u.removeOption(i.Id),0}else return f(i)}},load:function(i,r){var u=this;if(!i.length)return r();i.length>=t.minCantSearchChar?n.ajax({url:t.actionController,type:"GET",dataType:"json",data:{q:i},error:function(){r()},success:function(n){r(n.aaData)}}):r()},onInitialize:function(){var i=this;t.selectValue?i.load(function(r){n.ajax({url:t.actionControllerSelect,type:"GET",dataType:"json",data:{q:t.selectValue.toString()},error:function(){r()},success:function(u){r(u.aaData);i.setValue(t.selectValue);n("#h"+t.name+t.view).val(t.selectValue.toString())}})}):n("#h"+t.name+t.view).val("");t.disable&&i.disable()},onOptionAdd:function(n){isNaN(n)&&t.create&&r.push(n)},onOptionRemove:function(t){var i=n.inArray(t,r);i>=0&&r.splice(i,1)},render:{option_create:function(n,t){return'<div class="create">Buscar <strong>'+t(n.input)+"<\/strong>&hellip;<\/div>"}}})},parseOptions:function(i,r){var e,u,f,o;for(this.options=n.extend(!0,{},t.prototype.options),e=[i,r],f=0;f<e.length;f++){if(u=e[f],typeof u=="undefined")break;if(typeof u!="object")this.options.text=u;else for(o in u)this.options[o]=u[o]}}}),t};return i(t)})